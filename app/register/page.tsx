\'use client\';\n\nimport { useState, useEffect } from \'react\';\nimport { sdk } from \'@/lib/sdk\';\nimport { useRouter } from \'next/navigation\';\nimport { Condominium } from \'@shared/schema\';\n\nexport default function RegisterPage() {\n  const [step, setStep] = useState(1);\n  const [condominiums, setCondominiums] = useState<Condominium[]>([]);\n  const [selectedCondo, setSelectedCondo] = useState<Condominium | null>(null);\n  const [formData, setFormData] = useState({\n    name: \'\',\n    email: \'\',\n    password: \'\',\n    block: \'\',\n    unit: \'\',\n    inviteCode: \'\',\n  });\n  const [error, setError] = useState<string | null>(null);\n  const router = useRouter();\n\n  useEffect(() => {\n    async function fetchCondos() {\n      try {\n        const condos = await sdk.auth.getApprovedCondominiums();\n        setCondominiums(condos);\n      } catch (err) {\n        setError(\'Falha ao carregar condomínios. Tente novamente mais tarde.\');\n      }\n    }\n    fetchCondos();\n  }, []);\n\n  const handleCondoSelect = (condo: Condominium) => {\n    setSelectedCondo(condo);\n    setStep(2);\n  };\n\n  const handleFormChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    try {\n      await sdk.auth.register(formData, formData.inviteCode);\n      // Registration successful, redirect to login page\n      router.push(\'/login\');\n    } catch (err: any) {\n      setError(err.message);\n    }\n  };\n\n  if (step === 1) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-100\">\n        <h1 className=\"text-2xl font-bold mb-6 text-gray-900 font-poppins\">Selecione seu Condomínio</h1>\n        {error && <p className=\"mb-4 text-sm text-red-600\">{error}</p>}\n        <div className=\"w-full max-w-md space-y-3\">\n          {condominiums.map(condo => (\n            <button\n              key={condo.id}\n              onClick={() => handleCondoSelect(condo)}\n              className=\"w-full p-4 text-left bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n            >\n              <p className=\"font-bold text-gray-800\">{condo.name}</p>\n              <p className=\"text-sm text-gray-600\">{condo.address}</p>\n            </button>\n          ))}\n        </div>\n         <p className=\"mt-6 text-sm text-center text-gray-600\">\n          Já tem uma conta?{\' \}\n          <a href=\"/login\" className=\"font-medium text-green-600 hover:text-green-500\">\n            Faça login\n          </a>\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen bg-gray-100\">\n      <div className=\"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md\">\n        <h1 className=\"text-2xl font-bold text-center text-gray-900 font-poppins\">Registrar em {selectedCondo?.name}</h1>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <input type=\"text\" name=\"name\" placeholder=\"Nome Completo\" onChange={handleFormChange} required className=\"w-full px-3 py-2 border rounded-md\" />\n          <input type=\"email\" name=\"email\" placeholder=\"E-mail\" onChange={handleFormChange} required className=\"w-full px-3 py-2 border rounded-md\" />\n          <input type=\"password\" name=\"password\" placeholder=\"Senha\" onChange={handleFormChange} required className=\"w-full px-3 py-2 border rounded-md\" />\n          <div className=\"flex space-x-2\">\n            <input type=\"text\" name=\"block\" placeholder=\"Bloco\" onChange={handleFormChange} required className=\"w-1/2 px-3 py-2 border rounded-md\" />\n            <input type=\"text\" name=\"unit\" placeholder=\"Unidade\" onChange={handleFormChange} required className=\"w-1/2 px-3 py-2 border rounded-md\" />\n          </div>\n          <input type=\"text\" name=\"inviteCode\" placeholder=\"Código de Convite\" onChange={handleFormChange} required className=\"w-full px-3 py-2 border rounded-md\" />\n          {error && <p className=\"text-sm text-red-600\">{error}</p>}\n          <button type=\"submit\" className=\"w-full px-4 py-2 font-bold text-white bg-green-600 rounded-md hover:bg-green-700\">\n            Registrar\n          </button>\n        </form>\n         <button onClick={() => setStep(1)} className=\"w-full mt-2 text-sm text-center text-gray-600 hover:text-gray-800\">\n            Voltar para a seleção de condomínio\n        </button>\n      </div>\n    </div>\n  );\n}\n