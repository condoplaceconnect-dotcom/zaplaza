\'use client\';\n\nimport { useEffect, useState } from \'react\';\nimport { adminSDK } from \'@/lib/AdminSDK\';\nimport { useAuth } from \'@/hooks/AuthContext\';\nimport { Condominium, Report } from \'@shared/schema\';\nimport { useRouter } from \'next/navigation\';\n\nexport default function AdminDashboard() {\n    const { user, isAdmin, isLoading } = useAuth();\n    const router = useRouter();\n    const [pendingCondos, setPendingCondos] = useState<Condominium[]>([]);\n    const [reports, setReports] = useState<Report[]>([]);\n    const [error, setError] = useState<string | null>(null);\n\n    useEffect(() => {\n        if (!isLoading && !isAdmin) {\n            router.push(\'/login\'); // Redirect if not an admin\n        }\n\n        if (isAdmin) {\n            fetchAdminData();\n        }\n    }, [isLoading, isAdmin, router]);\n\n    const fetchAdminData = async () => {\n        try {\n            const [condos, reportsData] = await Promise.all([\n                adminSDK.condominiums.listPending(),\n                adminSDK.reports.list(),\n            ]);\n            setPendingCondos(condos);\n            setReports(reportsData);\n        } catch (err: any) {\n            setError(err.message || \'Failed to fetch admin data.\');\n        }\n    };\n\n    const handleApprove = async (condoId: string) => {\n        if (!confirm(\'Tem certeza que deseja aprovar este condomínio?\')) return;\n        try {\n            await adminSDK.condominiums.approve(condoId);\n            // Refresh the list after approval\n            setPendingCondos(current => current.filter(c => c.id !== condoId));\n        } catch (err: any) {\n            setError(err.message || \'Failed to approve condominium.\');\n        }\n    };\n\n    if (isLoading) return <div>Carregando...</div>;\n    if (!isAdmin) return <div>Acesso negado.</div>;\n
    return (\n        <div className=\"container mx-auto p-6 font-inter\">\n            <h1 className=\"text-3xl font-bold font-poppins text-gray-800 mb-8\">Painel de Administração</h1>\n
            {error && <p className=\"text-red-500 bg-red-100 p-3 rounded-md mb-6\">{error}</p>}\n\n            {/* Pending Condominiums Section */}\n            <div className=\"mb-10\">\n                <h2 className=\"text-2xl font-semibold text-gray-700 mb-4\">Condomínios Pendentes de Aprovação</h2>\n                <div className=\"bg-white rounded-lg border shadow-sm\">\n                    <ul className=\"divide-y divide-gray-200\">\n                        {pendingCondos.length > 0 ? (\n                            pendingCondos.map(condo => (\n                                <li key={condo.id} className=\"p-4 flex justify-between items-center\">\n                                    <div>\n                                        <p className=\"font-bold text-lg\">{condo.name}</p>\n                                        <p className=\"text-sm text-gray-600\">{condo.address}</p>\n                                    </div>\n                                    <button \n                                        onClick={() => handleApprove(condo.id)}\n                                        className=\"px-4 py-2 font-bold text-white bg-green-500 rounded-lg hover:bg-green-600\">\n                                        Aprovar\n                                    </button>\n                                </li>\n                            ))\n                        ) : (\n                            <li className=\"p-4 text-center text-gray-500\">Nenhum condomínio pendente.</li>\n                        )}\n                    </ul>\n                </div>\n            </div>\n
            {/* Recent Reports Section */}\n            <div>\n                <h2 className=\"text-2xl font-semibold text-gray-700 mb-4\">Últimas Denúncias</h2>\n                <div className=\"bg-white rounded-lg border shadow-sm\">\n                     <ul className=\"divide-y divide-gray-200\">\n                        {reports.length > 0 ? (\n                            reports.map(report => (\n                                <li key={report.id} className=\"p-4\">\n                                    <p className=\"font-bold\">{report.reason}</p>\n                                    <p className=\"text-sm text-gray-600 mt-1\">{report.description}</p>\n                                     <p className=\"text-xs text-gray-500 mt-2\">Reportado por: {report.reporterId} em {new Date(report.createdAt).toLocaleDateString()}</p>\n                                </li>\n                            ))\n                        ) : (\n                             <li className=\"p-4 text-center text-gray-500\">Nenhuma denúncia registrada.</li>\n                        )}\n                    </ul>\n                </div>\n            </div>\n        </div>\n    );\n}\n